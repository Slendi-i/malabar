#!/bin/bash

echo "üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–ï–†–°–ò–°–¢–ï–ù–¢–ù–û–°–¢–ò –ë–î"
echo "================================="

echo "1Ô∏è‚É£ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ —Å GitHub..."
cd /var/www/malabar
git fetch origin main
git reset --hard origin/main

echo ""
echo "2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π..."
echo "‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ pages/index.js"
echo "‚úÖ –£–±—Ä–∞–Ω–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å –ë–î –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö"
echo "‚úÖ apiService.js –±–æ–ª—å—à–µ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö"

echo ""
echo "3Ô∏è‚É£ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ frontend –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π..."
pm2 restart malabar-frontend-dev

echo ""
echo "4Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞..."
pm2 status

echo ""
echo "5Ô∏è‚É£ –¢–µ—Å—Ç API..."
curl -s http://localhost:3001/api/health | head -1
curl -s http://localhost:3001/api/players | jq length 2>/dev/null || echo "Players count: $(curl -s http://localhost:3001/api/players | grep -o '\"id\"' | wc -l)"

echo ""
echo "‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û!"
echo ""
echo "üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:"
echo "1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç: http://46.173.17.229:3000"
echo "2. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ admin/admin"
echo "3. –ò–∑–º–µ–Ω–∏—Ç–µ –∏–º—è –∏–≥—Ä–æ–∫–∞ –≤ –ø—Ä–æ—Ñ–∏–ª–µ"
echo "4. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –≤ –¥—Ä—É–≥–æ–º –±—Ä–∞—É–∑–µ—Ä–µ/—É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ"
echo "5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å"
echo ""
echo "üìä –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:"
echo "- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –ë–î"
echo "- –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏"
echo -e "- –ù–ï —Å–æ–∑–¥–∞—é—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∏–≥—Ä–æ–∫–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API\n"
